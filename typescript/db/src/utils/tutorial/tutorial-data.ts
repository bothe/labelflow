import { Label as GraphQlLabel, LabelType } from "@labelflow/graphql-types";
import { LABEL_CLASS_COLOR_PALETTE } from "@labelflow/utils";
import {
  Dataset,
  Image,
  Label as PrismaLabel,
  LabelClass,
} from "@prisma/client";
import { range } from "lodash/fp";

export type TutorialDataset = Pick<Dataset, "name">;

export type TutorialImage = Pick<
  Image,
  "externalUrl" | "name" | "width" | "height" | "mimetype"
>;

export type TutorialLabelClass = Pick<LabelClass, "index" | "name" | "color">;

export type TutorialLabel = Pick<
  PrismaLabel,
  "labelClassId" | "x" | "y" | "width" | "height"
> &
  Pick<GraphQlLabel, "type" | "geometry">;

export const TUTORIAL_DATASET: TutorialDataset = {
  name: "Tutorial",
};

const getTutorialImage = (rootUrl: string, index: number): TutorialImage => ({
  externalUrl: `${rootUrl}/static/img/tutorial-image-${index + 1}.jpg`,
  name: `Image ${index + 1}`,
  width: 2500,
  height: 1667,
  mimetype: "image/jpeg",
});

export const getTutorialImages = (rootUrl: string): TutorialImage[] =>
  range(0, 6).map((index) => getTutorialImage(rootUrl, index));

export const TUTORIAL_LABEL_CLASS: TutorialLabelClass = {
  index: 0,
  name: "Horse",
  color: LABEL_CLASS_COLOR_PALETTE[0],
};

export const getTutorialLabels = (labelClassId: string): TutorialLabel[] => [
  {
    labelClassId: null,
    x: 1399.9089081651664,
    y: 446.2497676315852,
    width: 179.36883194633174,
    height: 182.59331238677532,
    type: LabelType.Box,
    geometry: {
      type: "Polygon",
      coordinates: [
        [
          [1399.9089081651664, 446.2497676315852],
          [1579.2777401114981, 446.2497676315852],
          [1579.2777401114981, 628.8430800183605],
          [1399.9089081651664, 628.8430800183605],
          [1399.9089081651664, 446.2497676315852],
        ],
      ],
    },
  },
  {
    labelClassId: null,
    x: 521.4912592031518,
    y: 424.03607721605067,
    width: 153.09015568472773,
    height: 244.1946831444609,
    type: LabelType.Box,
    geometry: {
      type: "Polygon",
      coordinates: [
        [
          [521.4912592031518, 424.03607721605067],
          [674.5814148878795, 424.03607721605067],
          [674.5814148878795, 668.2307603605116],
          [521.4912592031518, 668.2307603605116],
          [521.4912592031518, 424.03607721605067],
        ],
      ],
    },
  },
  {
    labelClassId: null,
    x: 0.6954090947690474,
    y: 367.6221793163677,
    width: 157.71385707254922,
    height: 136.81170410486232,
    type: LabelType.Box,
    geometry: {
      type: "Polygon",
      coordinates: [
        [
          [0.6954090947690474, 367.6221793163677],
          [158.40926616731826, 367.6221793163677],
          [158.40926616731826, 504.43388342123],
          [0.6954090947690474, 504.43388342123],
          [0.6954090947690474, 367.6221793163677],
        ],
      ],
    },
  },
  {
    labelClassId,
    x: 2260.56395501186,
    y: 959.1327316049208,
    width: 130.18748222894828,
    height: 228.65789276832538,
    type: LabelType.Box,
    geometry: {
      type: "Polygon",
      coordinates: [
        [
          [2260.56395501186, 959.1327316049208],
          [2390.751437240808, 959.1327316049208],
          [2390.751437240808, 1187.7906243732461],
          [2260.56395501186, 1187.7906243732461],
          [2260.56395501186, 959.1327316049208],
        ],
      ],
    },
  },
  {
    labelClassId: null,
    x: 1996.4226900095955,
    y: 1359.5804903586006,
    width: 173.35982511251723,
    height: 44.39210727193563,
    type: LabelType.Box,
    geometry: {
      type: "Polygon",
      coordinates: [
        [
          [1996.4226900095955, 1359.5804903586006],
          [2169.7825151221127, 1359.5804903586006],
          [2169.7825151221127, 1403.9725976305363],
          [1996.4226900095955, 1403.9725976305363],
          [1996.4226900095955, 1359.5804903586006],
        ],
      ],
    },
  },
  {
    labelClassId: null,
    x: 734.7559483316069,
    y: 387.19013009195646,
    width: 145.013853175951,
    height: 270.52021799053136,
    type: LabelType.Box,
    geometry: {
      type: "Polygon",
      coordinates: [
        [
          [734.7559483316069, 387.19013009195646],
          [879.7698015075579, 387.19013009195646],
          [879.7698015075579, 657.7103480824878],
          [734.7559483316069, 657.7103480824878],
          [734.7559483316069, 387.19013009195646],
        ],
      ],
    },
  },
  {
    labelClassId,
    x: 1639.0982578311537,
    y: 1041.0029081292073,
    width: 206.16400407461379,
    height: 354.96464752386396,
    type: LabelType.Box,
    geometry: {
      type: "Polygon",
      coordinates: [
        [
          [1639.0982578311537, 1041.0029081292073],
          [1845.2622619057674, 1041.0029081292073],
          [1845.2622619057674, 1395.9675556530713],
          [1639.0982578311537, 1395.9675556530713],
          [1639.0982578311537, 1041.0029081292073],
        ],
      ],
    },
  },
  {
    labelClassId,
    x: 1050.6194882147552,
    y: 533.3125090123597,
    width: 264.6054613340166,
    height: 134.08705548424882,
    type: LabelType.Box,
    geometry: {
      type: "Polygon",
      coordinates: [
        [
          [1050.6194882147552, 533.3125090123597],
          [1315.2249495487717, 533.3125090123597],
          [1315.2249495487717, 667.3995644966085],
          [1050.6194882147552, 667.3995644966085],
          [1050.6194882147552, 533.3125090123597],
        ],
      ],
    },
  },
  {
    labelClassId: null,
    x: 1988,
    y: 249,
    height: 389,
    width: 274,
    type: LabelType.Polygon,
    geometry: {
      type: "Polygon",
      coordinates: [
        [
          [2198, 638],
          [2185, 616],
          [2169, 609],
          [2141, 589],
          [2117, 552],
          [2112, 552],
          [2083, 567],
          [2046, 572],
          [2026, 566],
          [2008, 551],
          [1996, 531],
          [1988, 503],
          [1988, 467],
          [1996, 418],
          [1992, 341],
          [1998, 325],
          [2011, 326],
          [2021, 355],
          [2027, 398],
          [2031, 406],
          [2040, 412],
          [2046, 405],
          [2040, 369],
          [2044, 310],
          [2049, 308],
          [2061, 315],
          [2064, 320],
          [2075, 370],
          [2084, 391],
          [2122, 386],
          [2129, 382],
          [2131, 376],
          [2139, 302],
          [2145, 293],
          [2157, 289],
          [2166, 298],
          [2170, 310],
          [2166, 373],
          [2174, 381],
          [2179, 373],
          [2185, 306],
          [2191, 281],
          [2203, 255],
          [2213, 249],
          [2218, 253],
          [2214, 296],
          [2214, 345],
          [2236, 445],
          [2232, 480],
          [2244, 487],
          [2254, 501],
          [2262, 595],
          [2254, 613],
          [2246, 619],
          [2231, 623],
          [2219, 621],
          [2206, 635],
          [2198, 638],
        ],
      ],
    },
  },
  {
    labelClassId,
    x: 1756,
    y: 408,
    height: 254,
    width: 365,
    type: LabelType.Polygon,
    geometry: {
      type: "Polygon",
      coordinates: [
        [
          [1756, 431],
          [1759, 413],
          [1764, 409],
          [1782, 409],
          [1809, 440],
          [1812, 436],
          [1812, 415],
          [1823, 408],
          [1832, 408],
          [1837, 415],
          [1848, 465],
          [1856, 474],
          [1887, 458],
          [1911, 450],
          [1953, 448],
          [1986, 452],
          [1989, 455],
          [1988, 498],
          [1992, 522],
          [2002, 542],
          [2016, 558],
          [2035, 568],
          [2048, 570],
          [2083, 568],
          [2108, 558],
          [2112, 560],
          [2121, 598],
          [2120, 633],
          [2114, 640],
          [2107.6422211424197, 628.3073322470922],
          [2097.969753039923, 632.9916114484339],
          [2101.1017187080897, 647.2466131468035],
          [2097, 656],
          [2092, 661],
          [2085, 662],
          [2072, 648],
          [2030, 628],
          [1998, 608],
          [1986, 595],
          [1963.9859724579655, 574.1531003026408],
          [1954.7212270191699, 569.4329479271864],
          [1944.16714489187, 569.6825408118125],
          [1905, 574],
          [1864, 583],
          [1835, 583],
          [1805, 575],
          [1781, 562],
          [1769, 551],
          [1760, 526],
          [1759, 447],
          [1756, 431],
        ],
      ],
    },
  },
];
